name: Build and Deploy (CD pipeline)

permissions:
    contents: read
    packages: write

on:
    push:
        branches:
        - main
    pull_request:
        branches:
        - main
    workflow_dispatch:
    workflow_run:
        workflows: ["trivy-sbom.yml", "trivy-scan.yml", "zap-scan.yml"]
        types: [completed]

jobs:
    security-scan-summary:
        runs-on: ubuntu-latest
        steps:
            - 
                name: Checkout repository
                uses: actions/checkout@v4

            - 
                name: Generate SAST Summary Report
                if: always()
                run: |
                    echo "# ðŸ”’ SAST Security Analysis Summary" >> $GITHUB_STEP_SUMMARY
                    echo "" >> $GITHUB_STEP_SUMMARY
                    echo "## Analysis Tools Run:" >> $GITHUB_STEP_SUMMARY
                    echo "- âœ… Bandit (Python security)" >> $GITHUB_STEP_SUMMARY
                    echo "- âœ… Trivy (Code security & Container Security & Dependency Check)" >> $GITHUB_STEP_SUMMARY
                    echo "ðŸ“Š View detailed reports in the artifacts section." >> $GITHUB_STEP_SUMMARY

